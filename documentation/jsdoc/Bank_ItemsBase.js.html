

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: Bank/ItemsBase.js | Companion</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 147px; height: 24px">
        
            <a href="https://bitfocus.io" rel="noopener noreferrer" target="_blank">
                <img src="https://bitfocus.io/images/topbar-logowhite.png" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Companion</a></h1>
        
            <span class="version">v2.3.0</span>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="BankActionController.html">BankActionController</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankActionController_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankActionController.html#actions">actions</a></li><li><a href="BankActionController.html#actionsRunning">actionsRunning</a></li><li><a href="BankActionController.html#bank">bank</a></li><li><a href="BankActionController.html#bankStatus">bankStatus</a></li><li><a href="BankActionController.html#config">config</a></li><li><a href="BankActionController.html#db">db</a></li><li><a href="BankActionController.html#debug">debug</a></li><li><a href="BankActionController.html#definitions">definitions</a></li><li><a href="BankActionController.html#deviceController">deviceController</a></li><li><a href="BankActionController.html#graphics">graphics</a></li><li><a href="BankActionController.html#instance">instance</a></li><li><a href="BankActionController.html#io">io</a></li><li><a href="BankActionController.html#logSource">logSource</a></li><li><a href="BankActionController.html#page">page</a></li><li><a href="BankActionController.html#.PageStyles">PageStyles</a></li><li><a href="BankActionController.html#registry">registry</a></li><li><a href="BankActionController.html#releaseActions">releaseActions</a></li><li><a href="BankActionController.html#schedule">schedule</a></li><li><a href="BankActionController.html#services">services</a></li><li><a href="BankActionController.html#skipNext">skipNext</a></li><li><a href="BankActionController.html#skipUp">skipUp</a></li><li><a href="BankActionController.html#system">system</a></li><li><a href="BankActionController.html#timersRunning">timersRunning</a></li><li><a href="BankActionController.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="BankActionController.html#log">log</a></li></ul></div></li><li><a href="BankActionDefinition.html">BankActionDefinition</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankActionDefinition_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankActionDefinition.html#label">label</a></li><li><a href="BankActionDefinition.html#options">options</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="BankActionDefinition.html#callback">callback</a></li><li><a href="BankActionDefinition.html#subscribe">subscribe</a></li><li><a href="BankActionDefinition.html#unsubscribe">unsubscribe</a></li></ul></div></li><li><a href="BankActionItems.html">BankActionItems</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankActionItems_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankActionItems.html#bank">bank</a></li><li><a href="BankActionItems.html#config">config</a></li><li><a href="BankActionItems.html#controller">controller</a></li><li><a href="BankActionItems.html#db">db</a></li><li><a href="BankActionItems.html#dbKey">dbKey</a></li><li><a href="BankActionItems.html#debug">debug</a></li><li><a href="BankActionItems.html#definitions">definitions</a></li><li><a href="BankActionItems.html#deviceController">deviceController</a></li><li><a href="BankActionItems.html#graphics">graphics</a></li><li><a href="BankActionItems.html#instance">instance</a></li><li><a href="BankActionItems.html#io">io</a></li><li><a href="BankActionItems.html#items">items</a></li><li><a href="BankActionItems.html#logSource">logSource</a></li><li><a href="BankActionItems.html#page">page</a></li><li><a href="BankActionItems.html#registry">registry</a></li><li><a href="BankActionItems.html#schedule">schedule</a></li><li><a href="BankActionItems.html#services">services</a></li><li><a href="BankActionItems.html#system">system</a></li><li><a href="BankActionItems.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="BankActionItems.html#addItem">addItem</a></li><li><a href="BankActionItems.html#addItemByClient">addItemByClient</a></li><li><a href="BankActionItems.html#checkBankExists">checkBankExists</a></li><li><a href="BankActionItems.html#checkBankStatus">checkBankStatus</a></li><li><a href="BankActionItems.html#checkInstanceStatus">checkInstanceStatus</a></li><li><a href="BankActionItems.html#checkStatus">checkStatus</a></li><li><a href="BankActionItems.html#cleanupItems">cleanupItems</a></li><li><a href="BankActionItems.html#deleteInstance">deleteInstance</a></li><li><a href="BankActionItems.html#deleteItem">deleteItem</a></li><li><a href="BankActionItems.html#deleteItemByClient">deleteItemByClient</a></li><li><a href="BankActionItems.html#getAll">getAll</a></li><li><a href="BankActionItems.html#getBank">getBank</a></li><li><a href="BankActionItems.html#getBankByClient">getBankByClient</a></li><li><a href="BankActionItems.html#getInstanceItems">getInstanceItems</a></li><li><a href="BankActionItems.html#getPage">getPage</a></li><li><a href="BankActionItems.html#importBank">importBank</a></li><li><a href="BankActionItems.html#log">log</a></li><li><a href="BankActionItems.html#resetBank">resetBank</a></li><li><a href="BankActionItems.html#save">save</a></li><li><a href="BankActionItems.html#setDefinitions">setDefinitions</a></li><li><a href="BankActionItems.html#subscribe">subscribe</a></li><li><a href="BankActionItems.html#subscribeBank">subscribeBank</a></li><li><a href="BankActionItems.html#unsubscribe">unsubscribe</a></li><li><a href="BankActionItems.html#unsubscribeBank">unsubscribeBank</a></li><li><a href="BankActionItems.html#updateItemDelay">updateItemDelay</a></li><li><a href="BankActionItems.html#updateItemOption">updateItemOption</a></li><li><a href="BankActionItems.html#updateItemOrder">updateItemOrder</a></li></ul></div></li><li><a href="BankController.html">BankController</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankController_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankController.html#actions">actions</a></li><li><a href="BankController.html#bank">bank</a></li><li><a href="BankController.html#config">config</a></li><li><a href="BankController.html#db">db</a></li><li><a href="BankController.html#debug">debug</a></li><li><a href="BankController.html#deviceController">deviceController</a></li><li><a href="BankController.html#feedback">feedback</a></li><li><a href="BankController.html#fields">fields</a></li><li><a href="BankController.html#graphics">graphics</a></li><li><a href="BankController.html#instance">instance</a></li><li><a href="BankController.html#io">io</a></li><li><a href="BankController.html#logSource">logSource</a></li><li><a href="BankController.html#page">page</a></li><li><a href="BankController.html#registry">registry</a></li><li><a href="BankController.html#schedule">schedule</a></li><li><a href="BankController.html#services">services</a></li><li><a href="BankController.html#system">system</a></li><li><a href="BankController.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="BankController.html#log">log</a></li></ul></div></li><li><a href="BankFeedbackController.html">BankFeedbackController</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankFeedbackController_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankFeedbackController.html#bank">bank</a></li><li><a href="BankFeedbackController.html#config">config</a></li><li><a href="BankFeedbackController.html#db">db</a></li><li><a href="BankFeedbackController.html#debug">debug</a></li><li><a href="BankFeedbackController.html#deviceController">deviceController</a></li><li><a href="BankFeedbackController.html#graphics">graphics</a></li><li><a href="BankFeedbackController.html#instance">instance</a></li><li><a href="BankFeedbackController.html#io">io</a></li><li><a href="BankFeedbackController.html#logSource">logSource</a></li><li><a href="BankFeedbackController.html#page">page</a></li><li><a href="BankFeedbackController.html#registry">registry</a></li><li><a href="BankFeedbackController.html#schedule">schedule</a></li><li><a href="BankFeedbackController.html#services">services</a></li><li><a href="BankFeedbackController.html#system">system</a></li><li><a href="BankFeedbackController.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="BankFeedbackController.html#log">log</a></li></ul></div></li><li><a href="BankFeedbackDefinition.html">BankFeedbackDefinition</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankFeedbackDefinition_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankFeedbackDefinition.html#description">description</a></li><li><a href="BankFeedbackDefinition.html#label">label</a></li><li><a href="BankFeedbackDefinition.html#options">options</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="BankFeedbackDefinition.html#callback">callback</a></li><li><a href="BankFeedbackDefinition.html#subscribe">subscribe</a></li><li><a href="BankFeedbackDefinition.html#unsubscribe">unsubscribe</a></li></ul></div></li><li><a href="BankFeedbackItems.html">BankFeedbackItems</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankFeedbackItems_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankFeedbackItems.html#bank">bank</a></li><li><a href="BankFeedbackItems.html#config">config</a></li><li><a href="BankFeedbackItems.html#controller">controller</a></li><li><a href="BankFeedbackItems.html#db">db</a></li><li><a href="BankFeedbackItems.html#dbKey">dbKey</a></li><li><a href="BankFeedbackItems.html#debug">debug</a></li><li><a href="BankFeedbackItems.html#definitions">definitions</a></li><li><a href="BankFeedbackItems.html#deviceController">deviceController</a></li><li><a href="BankFeedbackItems.html#graphics">graphics</a></li><li><a href="BankFeedbackItems.html#instance">instance</a></li><li><a href="BankFeedbackItems.html#io">io</a></li><li><a href="BankFeedbackItems.html#items">items</a></li><li><a href="BankFeedbackItems.html#logSource">logSource</a></li><li><a href="BankFeedbackItems.html#page">page</a></li><li><a href="BankFeedbackItems.html#registry">registry</a></li><li><a href="BankFeedbackItems.html#schedule">schedule</a></li><li><a href="BankFeedbackItems.html#services">services</a></li><li><a href="BankFeedbackItems.html#system">system</a></li><li><a href="BankFeedbackItems.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="BankFeedbackItems.html#addItem">addItem</a></li><li><a href="BankFeedbackItems.html#addItemByClient">addItemByClient</a></li><li><a href="BankFeedbackItems.html#checkBankExists">checkBankExists</a></li><li><a href="BankFeedbackItems.html#checkBankStatus">checkBankStatus</a></li><li><a href="BankFeedbackItems.html#checkInstanceStatus">checkInstanceStatus</a></li><li><a href="BankFeedbackItems.html#checkStatus">checkStatus</a></li><li><a href="BankFeedbackItems.html#cleanupItems">cleanupItems</a></li><li><a href="BankFeedbackItems.html#deleteInstance">deleteInstance</a></li><li><a href="BankFeedbackItems.html#deleteItem">deleteItem</a></li><li><a href="BankFeedbackItems.html#deleteItemByClient">deleteItemByClient</a></li><li><a href="BankFeedbackItems.html#getAll">getAll</a></li><li><a href="BankFeedbackItems.html#getBank">getBank</a></li><li><a href="BankFeedbackItems.html#getBankByClient">getBankByClient</a></li><li><a href="BankFeedbackItems.html#getBankStyles">getBankStyles</a></li><li><a href="BankFeedbackItems.html#getInstanceItems">getInstanceItems</a></li><li><a href="BankFeedbackItems.html#getPage">getPage</a></li><li><a href="BankFeedbackItems.html#getStyle">getStyle</a></li><li><a href="BankFeedbackItems.html#importBank">importBank</a></li><li><a href="BankFeedbackItems.html#log">log</a></li><li><a href="BankFeedbackItems.html#resetBank">resetBank</a></li><li><a href="BankFeedbackItems.html#save">save</a></li><li><a href="BankFeedbackItems.html#setDefinitions">setDefinitions</a></li><li><a href="BankFeedbackItems.html#setStyle">setStyle</a></li><li><a href="BankFeedbackItems.html#subscribe">subscribe</a></li><li><a href="BankFeedbackItems.html#subscribeBank">subscribeBank</a></li><li><a href="BankFeedbackItems.html#unsubscribe">unsubscribe</a></li><li><a href="BankFeedbackItems.html#unsubscribeBank">unsubscribeBank</a></li><li><a href="BankFeedbackItems.html#updateItemOption">updateItemOption</a></li><li><a href="BankFeedbackItems.html#updateItemOrder">updateItemOrder</a></li></ul></div></li><li><a href="BankItemDefinition.html">BankItemDefinition</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankItemDefinition_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankItemDefinition.html#label">label</a></li><li><a href="BankItemDefinition.html#options">options</a></li></ul></div></li><li><a href="BankItemsBase.html">BankItemsBase</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankItemsBase_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankItemsBase.html#bank">bank</a></li><li><a href="BankItemsBase.html#config">config</a></li><li><a href="BankItemsBase.html#controller">controller</a></li><li><a href="BankItemsBase.html#db">db</a></li><li><a href="BankItemsBase.html#dbKey">dbKey</a></li><li><a href="BankItemsBase.html#definitions">definitions</a></li><li><a href="BankItemsBase.html#deviceController">deviceController</a></li><li><a href="BankItemsBase.html#graphics">graphics</a></li><li><a href="BankItemsBase.html#instance">instance</a></li><li><a href="BankItemsBase.html#io">io</a></li><li><a href="BankItemsBase.html#items">items</a></li><li><a href="BankItemsBase.html#logSource">logSource</a></li><li><a href="BankItemsBase.html#page">page</a></li><li><a href="BankItemsBase.html#registry">registry</a></li><li><a href="BankItemsBase.html#schedule">schedule</a></li><li><a href="BankItemsBase.html#services">services</a></li><li><a href="BankItemsBase.html#system">system</a></li><li><a href="BankItemsBase.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="BankItemsBase.html#addItem">addItem</a></li><li><a href="BankItemsBase.html#addItemByClient">addItemByClient</a></li><li><a href="BankItemsBase.html#checkBankExists">checkBankExists</a></li><li><a href="BankItemsBase.html#checkInstanceStatus">checkInstanceStatus</a></li><li><a href="BankItemsBase.html#checkStatus">checkStatus</a></li><li><a href="BankItemsBase.html#cleanupItems">cleanupItems</a></li><li><a href="BankItemsBase.html#deleteInstance">deleteInstance</a></li><li><a href="BankItemsBase.html#deleteItem">deleteItem</a></li><li><a href="BankItemsBase.html#deleteItemByClient">deleteItemByClient</a></li><li><a href="BankItemsBase.html#getAll">getAll</a></li><li><a href="BankItemsBase.html#getBank">getBank</a></li><li><a href="BankItemsBase.html#getBankByClient">getBankByClient</a></li><li><a href="BankItemsBase.html#getInstanceItems">getInstanceItems</a></li><li><a href="BankItemsBase.html#getPage">getPage</a></li><li><a href="BankItemsBase.html#importBank">importBank</a></li><li><a href="BankItemsBase.html#log">log</a></li><li><a href="BankItemsBase.html#resetBank">resetBank</a></li><li><a href="BankItemsBase.html#save">save</a></li><li><a href="BankItemsBase.html#setDefinitions">setDefinitions</a></li><li><a href="BankItemsBase.html#subscribe">subscribe</a></li><li><a href="BankItemsBase.html#subscribeBank">subscribeBank</a></li><li><a href="BankItemsBase.html#unsubscribe">unsubscribe</a></li><li><a href="BankItemsBase.html#unsubscribeBank">unsubscribeBank</a></li><li><a href="BankItemsBase.html#updateItemOption">updateItemOption</a></li><li><a href="BankItemsBase.html#updateItemOrder">updateItemOrder</a></li></ul></div></li><li><a href="BankStyle.html">BankStyle</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="BankStyle_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="BankStyle.html#alignment">alignment</a></li><li><a href="BankStyle.html#base64">base64</a></li><li><a href="BankStyle.html#bgcolor">bgcolor</a></li><li><a href="BankStyle.html#color">color</a></li><li><a href="BankStyle.html#png64">png64</a></li><li><a href="BankStyle.html#pngalignment">pngalignment</a></li><li><a href="BankStyle.html#size">size</a></li><li><a href="BankStyle.html#text">text</a></li></ul></div></li><li><a href="Config.html">Config</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Config_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Config.html#bank">bank</a></li><li><a href="Config.html#cfgDir">cfgDir</a></li><li><a href="Config.html#config">config</a></li><li><a href="Config.html#db">db</a></li><li><a href="Config.html#debug">debug</a></li><li><a href="Config.html#deviceController">deviceController</a></li><li><a href="Config.html#graphics">graphics</a></li><li><a href="Config.html#instance">instance</a></li><li><a href="Config.html#io">io</a></li><li><a href="Config.html#logSource">logSource</a></li><li><a href="Config.html#page">page</a></li><li><a href="Config.html#registry">registry</a></li><li><a href="Config.html#.SaveInterval">SaveInterval</a></li><li><a href="Config.html#schedule">schedule</a></li><li><a href="Config.html#services">services</a></li><li><a href="Config.html#system">system</a></li><li><a href="Config.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Config.html#deleteKey">deleteKey</a></li><li><a href="Config.html#doSave">doSave</a></li><li><a href="Config.html#getAll">getAll</a></li><li><a href="Config.html#getKey">getKey</a></li><li><a href="Config.html#loadBackupSync">loadBackupSync</a></li><li><a href="Config.html#loadDefaults">loadDefaults</a></li><li><a href="Config.html#loadSync">loadSync</a></li><li><a href="Config.html#log">log</a></li><li><a href="Config.html#save">save</a></li><li><a href="Config.html#saveImmediate">saveImmediate</a></li><li><a href="Config.html#setDirty">setDirty</a></li><li><a href="Config.html#setKey">setKey</a></li><li><a href="Config.html#setKeys">setKeys</a></li><li><a href="Config.html#setSaveCycle">setSaveCycle</a></li></ul></div></li><li><a href="CoreBase.html">CoreBase</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="CoreBase_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="CoreBase.html#bank">bank</a></li><li><a href="CoreBase.html#config">config</a></li><li><a href="CoreBase.html#db">db</a></li><li><a href="CoreBase.html#deviceController">deviceController</a></li><li><a href="CoreBase.html#graphics">graphics</a></li><li><a href="CoreBase.html#instance">instance</a></li><li><a href="CoreBase.html#io">io</a></li><li><a href="CoreBase.html#logSource">logSource</a></li><li><a href="CoreBase.html#page">page</a></li><li><a href="CoreBase.html#registry">registry</a></li><li><a href="CoreBase.html#schedule">schedule</a></li><li><a href="CoreBase.html#services">services</a></li><li><a href="CoreBase.html#system">system</a></li><li><a href="CoreBase.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="CoreBase.html#log">log</a></li></ul></div></li><li><a href="Database.html">Database</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Database_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Database.html#bank">bank</a></li><li><a href="Database.html#cfgDir">cfgDir</a></li><li><a href="Database.html#config">config</a></li><li><a href="Database.html#db">db</a></li><li><a href="Database.html#debug">debug</a></li><li><a href="Database.html#deviceController">deviceController</a></li><li><a href="Database.html#graphics">graphics</a></li><li><a href="Database.html#instance">instance</a></li><li><a href="Database.html#io">io</a></li><li><a href="Database.html#logSource">logSource</a></li><li><a href="Database.html#page">page</a></li><li><a href="Database.html#registry">registry</a></li><li><a href="Database.html#.SaveInterval">SaveInterval</a></li><li><a href="Database.html#schedule">schedule</a></li><li><a href="Database.html#services">services</a></li><li><a href="Database.html#system">system</a></li><li><a href="Database.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Database.html#deleteKey">deleteKey</a></li><li><a href="Database.html#doSave">doSave</a></li><li><a href="Database.html#getAll">getAll</a></li><li><a href="Database.html#getKey">getKey</a></li><li><a href="Database.html#loadBackupSync">loadBackupSync</a></li><li><a href="Database.html#loadDefaults">loadDefaults</a></li><li><a href="Database.html#loadSync">loadSync</a></li><li><a href="Database.html#log">log</a></li><li><a href="Database.html#save">save</a></li><li><a href="Database.html#saveImmediate">saveImmediate</a></li><li><a href="Database.html#setDirty">setDirty</a></li><li><a href="Database.html#setKey">setKey</a></li><li><a href="Database.html#setKeys">setKeys</a></li><li><a href="Database.html#setSaveCycle">setSaveCycle</a></li></ul></div></li><li><a href="DataStoreBase.html">DataStoreBase</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="DataStoreBase_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="DataStoreBase.html#bank">bank</a></li><li><a href="DataStoreBase.html#cfgDir">cfgDir</a></li><li><a href="DataStoreBase.html#config">config</a></li><li><a href="DataStoreBase.html#db">db</a></li><li><a href="DataStoreBase.html#deviceController">deviceController</a></li><li><a href="DataStoreBase.html#graphics">graphics</a></li><li><a href="DataStoreBase.html#instance">instance</a></li><li><a href="DataStoreBase.html#io">io</a></li><li><a href="DataStoreBase.html#logSource">logSource</a></li><li><a href="DataStoreBase.html#page">page</a></li><li><a href="DataStoreBase.html#registry">registry</a></li><li><a href="DataStoreBase.html#schedule">schedule</a></li><li><a href="DataStoreBase.html#services">services</a></li><li><a href="DataStoreBase.html#system">system</a></li><li><a href="DataStoreBase.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="DataStoreBase.html#deleteKey">deleteKey</a></li><li><a href="DataStoreBase.html#doSave">doSave</a></li><li><a href="DataStoreBase.html#getAll">getAll</a></li><li><a href="DataStoreBase.html#getKey">getKey</a></li><li><a href="DataStoreBase.html#loadBackupSync">loadBackupSync</a></li><li><a href="DataStoreBase.html#loadDefaults">loadDefaults</a></li><li><a href="DataStoreBase.html#loadSync">loadSync</a></li><li><a href="DataStoreBase.html#log">log</a></li><li><a href="DataStoreBase.html#save">save</a></li><li><a href="DataStoreBase.html#saveImmediate">saveImmediate</a></li><li><a href="DataStoreBase.html#setDirty">setDirty</a></li><li><a href="DataStoreBase.html#setKey">setKey</a></li><li><a href="DataStoreBase.html#setKeys">setKeys</a></li><li><a href="DataStoreBase.html#setSaveCycle">setSaveCycle</a></li></ul></div></li><li><a href="InterfaceClient.html">InterfaceClient</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="InterfaceClient_sub"><div class="member-type">Events</div><ul class="inner"><li><a href="InterfaceClient.html#~event:get_userconfig_all">get_userconfig_all</a></li><li><a href="InterfaceClient.html#~event:set_userconfig_key">set_userconfig_key</a></li><li><a href="InterfaceClient.html#~event:set_userconfig_key:result">set_userconfig_key:result</a></li></ul></div></li><li><a href="Registry.html">Registry</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Registry_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Registry.html#appRoot">appRoot</a></li><li><a href="Registry.html#bindIp">bindIp</a></li><li><a href="Registry.html#bindPort">bindPort</a></li><li><a href="Registry.html#buildNumber">buildNumber</a></li><li><a href="Registry.html#cfgDir">cfgDir</a></li><li><a href="Registry.html#debug">debug</a></li><li><a href="Registry.html#fileVersion">fileVersion</a></li><li><a href="Registry.html#logbuffer">logbuffer</a></li><li><a href="Registry.html#logwriting">logwriting</a></li><li><a href="Registry.html#pkgInfo">pkgInfo</a></li><li><a href="Registry.html#skeletonInfo">skeletonInfo</a></li><li><a href="Registry.html#startMinimised">startMinimised</a></li><li><a href="Registry.html#system">system</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Registry.html#exit">exit</a></li><li><a href="Registry.html#launch">launch</a></li><li><a href="Registry.html#quit">quit</a></li><li><a href="Registry.html#restart">restart</a></li><li><a href="Registry.html#startLogging">startLogging</a></li></ul></div></li><li><a href="ScheduleController.html">ScheduleController</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ScheduleController_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ScheduleController.html#bank">bank</a></li><li><a href="ScheduleController.html#config">config</a></li><li><a href="ScheduleController.html#db">db</a></li><li><a href="ScheduleController.html#debug">debug</a></li><li><a href="ScheduleController.html#deviceController">deviceController</a></li><li><a href="ScheduleController.html#graphics">graphics</a></li><li><a href="ScheduleController.html#instance">instance</a></li><li><a href="ScheduleController.html#io">io</a></li><li><a href="ScheduleController.html#logSource">logSource</a></li><li><a href="ScheduleController.html#page">page</a></li><li><a href="ScheduleController.html#registry">registry</a></li><li><a href="ScheduleController.html#schedule">schedule</a></li><li><a href="ScheduleController.html#services">services</a></li><li><a href="ScheduleController.html#system">system</a></li><li><a href="ScheduleController.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="ScheduleController.html#action">action</a></li><li><a href="ScheduleController.html#cleanConfig">cleanConfig</a></li><li><a href="ScheduleController.html#eventLoadType">eventLoadType</a></li><li><a href="ScheduleController.html#eventWatch">eventWatch</a></li><li><a href="ScheduleController.html#findEventIndex">findEventIndex</a></li><li><a href="ScheduleController.html#getBankButton">getBankButton</a></li><li><a href="ScheduleController.html#getNextId">getNextId</a></li><li><a href="ScheduleController.html#getPlugin">getPlugin</a></li><li><a href="ScheduleController.html#getSchedule">getSchedule</a></li><li><a href="ScheduleController.html#initConfig">initConfig</a></li><li><a href="ScheduleController.html#loadPlugins">loadPlugins</a></li><li><a href="ScheduleController.html#log">log</a></li><li><a href="ScheduleController.html#saveSchedule">saveSchedule</a></li><li><a href="ScheduleController.html#saveToDb">saveToDb</a></li><li><a href="ScheduleController.html#sendPlugins">sendPlugins</a></li><li><a href="ScheduleController.html#startSchedule">startSchedule</a></li><li><a href="ScheduleController.html#updateSchedule">updateSchedule</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="ScheduleController.html#~getSchedule-callback">getSchedule-callback</a></li><li><a href="ScheduleController.html#~saveSchedule-callback">saveSchedule-callback</a></li><li><a href="ScheduleController.html#~sendPlugins-callback">sendPlugins-callback</a></li><li><a href="ScheduleController.html#~updateSchedule-callback">updateSchedule-callback</a></li></ul></div></li><li><a href="SchedulePluginBase.html">SchedulePluginBase</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="SchedulePluginBase_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="SchedulePluginBase.html#multiple">multiple</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="SchedulePluginBase.html#add">add</a></li><li><a href="SchedulePluginBase.html#configDesc">configDesc</a></li><li><a href="SchedulePluginBase.html#frontEnd">frontEnd</a></li><li><a href="SchedulePluginBase.html#remove">remove</a></li><li><a href="SchedulePluginBase.html#setup">setup</a></li></ul></div></li><li><a href="ServiceBase.html">ServiceBase</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ServiceBase_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ServiceBase.html#bank">bank</a></li><li><a href="ServiceBase.html#config">config</a></li><li><a href="ServiceBase.html#db">db</a></li><li><a href="ServiceBase.html#deviceController">deviceController</a></li><li><a href="ServiceBase.html#graphics">graphics</a></li><li><a href="ServiceBase.html#instance">instance</a></li><li><a href="ServiceBase.html#io">io</a></li><li><a href="ServiceBase.html#logSource">logSource</a></li><li><a href="ServiceBase.html#page">page</a></li><li><a href="ServiceBase.html#registry">registry</a></li><li><a href="ServiceBase.html#schedule">schedule</a></li><li><a href="ServiceBase.html#services">services</a></li><li><a href="ServiceBase.html#system">system</a></li><li><a href="ServiceBase.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="ServiceBase.html#disableModule">disableModule</a></li><li><a href="ServiceBase.html#enableModule">enableModule</a></li><li><a href="ServiceBase.html#handleSocketError">handleSocketError</a></li><li><a href="ServiceBase.html#init">init</a></li><li><a href="ServiceBase.html#log">log</a></li><li><a href="ServiceBase.html#setDefaults">setDefaults</a></li><li><a href="ServiceBase.html#updateUserconfig">updateUserconfig</a></li></ul></div></li><li><a href="UserConfig.html">UserConfig</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="UserConfig_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="UserConfig.html#bank">bank</a></li><li><a href="UserConfig.html#config">config</a></li><li><a href="UserConfig.html#db">db</a></li><li><a href="UserConfig.html#debug">debug</a></li><li><a href="UserConfig.html#.Defaults">Defaults</a></li><li><a href="UserConfig.html#deviceController">deviceController</a></li><li><a href="UserConfig.html#graphics">graphics</a></li><li><a href="UserConfig.html#instance">instance</a></li><li><a href="UserConfig.html#io">io</a></li><li><a href="UserConfig.html#logSource">logSource</a></li><li><a href="UserConfig.html#page">page</a></li><li><a href="UserConfig.html#registry">registry</a></li><li><a href="UserConfig.html#schedule">schedule</a></li><li><a href="UserConfig.html#services">services</a></li><li><a href="UserConfig.html#system">system</a></li><li><a href="UserConfig.html#userconfig">userconfig</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="UserConfig.html#get">get</a></li><li><a href="UserConfig.html#getKey">getKey</a></li><li><a href="UserConfig.html#log">log</a></li><li><a href="UserConfig.html#setKey">setKey</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * This file is part of the Companion project
 * Copyright (c) 2021 Bitfocus AS
 *
 * This program is free software.
 * You should have received a copy of the MIT licence as well as the Bitfocus
 * Individual Contributor License Agreement for companion along with
 * this program.
 *
 * You can be released from the requirements of the license by purchasing
 * a commercial license. Buying such a license is mandatory as soon as you
 * develop commercial activities involving the Companion software without
 * disclosing the source code of your own applications.
 *
 */

const CoreBase = require('../Core/Base')
const shortid = require('shortid')
const { cloneDeep } = require('lodash')

/**
 * Abstract class to be extended and used by bank controllers to track their items.
 * See {@link BankActionItems} and {@link BankFeedbackItems}
 *
 * @extends CoreBase
 * @author Håkon Nessjøen &lt;haakon@bitfocus.io>
 * @author Keith Rocheck &lt;keith.rocheck@gmail.com>
 * @author William Viker &lt;william@bitfocus.io>
 * @since 2.3.0
 * @abstract
 * @copyright 2021 Bitfocus AS
 * @license
 * This program is free software.
 * You should have received a copy of the MIT licence as well as the Bitfocus
 * Individual Contributor License Agreement for Companion along with
 * this program.
 *
 * You can be released from the requirements of the license by purchasing
 * a commercial license. Buying such a license is mandatory as soon as you
 * develop commercial activities involving the Companion software without
 * disclosing the source code of your own applications.
 */
class BankItemsBase extends CoreBase {
	/**
	 * The parent controller
	 * @type {(BankActionController|BankFeedbackController)}
	 * @access protected
	 */
	controller = null
	/**
	 * The database to use load/save the items
	 * @type {string}
	 * @access protected
	 */
	dbKey = null
	/**
	 * Nested arrays for the definitions from the instances: &lt;code>[instance_id][item_id]&lt;/code>
	 * @type {Object.&lt;string,BankItemDefinition[]>}
	 * @access protected
	 */
	definitions = {}
	/**
	 * Nested arrays containing the items in the banks: &lt;code>[page][bank][item]&lt;/code>
	 * Also is the data that is stored to the DB.
	 * @type {Object.&lt;number,Array.&lt;number,Object.&lt;number,BankItem>>>}
	 * @access protected
	 */
	items = null

	/**
	 * Creates an item base object
	 * @param {Registry} registry - the core registry
	 * @param {(BankActionController|BankFeedbackController)} controller - the item's parent controller
	 * @param {string} logSource - module name to be used in logs
	 * @param {string} dbKey - the key to fetch from the database
	 */
	constructor(registry, controller, logSource, dbKey) {
		super(registry, logSource)
		this.controller = controller
		this.dbKey = dbKey

		this.items = this.db.getKey(this.dbKey, {})
		//this.cleanupItems()
	}

	/**
	 * Add an item to a bank
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @param {string} item - item information in form: `"instance_id:type"`
	 * @access public
	 */
	addItem(page, bank, item) {
		this.checkBankExists(page, bank)
		const s = item.split(/:/)

		let newItem = {
			id: shortid.generate(),
			label: item,
			type: s[1],
			instance: s[0],
			options: {},
		}

		if (!this.instance.getInstanceConfig(newItem.instance)) {
			// Item is not valid
			return
		}

		if (this.definitions[s[0]] !== undefined &amp;&amp; this.definitions[s[0]][s[1]] !== undefined) {
			let definition = this.definitions[s[0]][s[1]]

			if (definition.options !== undefined &amp;&amp; definition.options.length > 0) {
				for (let j in definition.options) {
					let opt = definition.options[j]
					newItem.options[opt.id] = opt.default
				}
			}
		}

		this.items[page][bank].push(newItem)
		this.subscribeItem(newItem)
	}

	/**
	 * Add item to a bank via a client socket
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @param {string} item - item information in form: `"instance_id:type"`
	 * @param {function} answer - UI callback
	 * @access public
	 */
	addItemByClient(page, bank, item, answer) {
		this.addItem(page, bank, item)

		this.save()
		answer(page, bank, this.items[page][bank])
		this.bank.checkBankStatus(page, bank)
	}

	/**
	 * Check if a bank exists and initialize it if it doesn't
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @access protected
	 */
	checkBankExists(page, bank) {
		if (this.items[page] === undefined) {
			this.items[page] = {}
		}

		if (this.items[page][bank] === undefined) {
			this.items[page][bank] = []
		}
	}

	/**
	 * Scan the page/bank array to find items for an instance or just specific types and populate an array with the findings
	 * @param {string} id - the instance ID to check for
	 * @param {string} type - the item type to check for
	 * @param {?Array.&lt;string,boolean>} checkQueue - array of flagged banks with keys of `[page_bank]`; empty by default but can have a populated version passed to be added to
	 * @returns {Array.&lt;string,boolean>} the populated `checkQueue`
	 * @access public
	 */
	checkInstanceStatus(id, type, checkQueue = []) {
		for (let page in this.items) {
			if (this.items[page] !== undefined) {
				for (let bank in this.items[page]) {
					if (this.items[page][bank] !== undefined) {
						for (let i = 0; i &lt; this.items[page][bank].length; ++i) {
							let item = this.items[page][bank][i]
							if (item.instance == id &amp;&amp; (type === undefined || item.type == type)) {
								checkQueue[page + '_' + bank] = true
								this.checkStatus(page, bank, i)
							}
						}
					}
				}
			}
		}

		return checkQueue
	}

	/**
	 * Check an item's status
	 * @param {number} page - the item's page
	 * @param {number} bank - the item's bank
	 * @param {number} i - the item's index
	 * @access protected
	 */
	checkStatus(page, bank, i) {}

	/**
	 * Checks all the items to ensure their instances still exist
	 * @access protected
	 */
	cleanupItems() {
		const res = {}

		for (var page in this.items) {
			res[page] = {}
			for (var bank in this.items[page]) {
				res[page][bank] = []

				if (this.items[page][bank] !== undefined) {
					for (var i = 0; i &lt; this.items[page][bank].length; ++i) {
						const item = this.items[page][bank][i]
						if (item &amp;&amp; this.instance.getInstanceConfig(item.instance)) {
							res[page][bank].push(item)
						}
					}
				}
			}
		}

		this.items = res
		this.db.setKey(this.dbKey, this.items)
	}

	/**
	 * Scan the page/bank array for items from an instance and delete them
	 * @param {string} id - the instance ID to delete
	 * @param {?Array.&lt;string,boolean>} checkQueue - array of changed banks with keys of `[page_bank]`; empty by default but can have a populated version passed to be added to
	 * @returns {Array.&lt;string,boolean>} the populated `checkQueue`
	 * @access public
	 */
	deleteInstance(id, checkQueue = []) {
		for (let page in this.items) {
			for (let bank in this.items[page]) {
				if (this.items[page][bank] !== undefined) {
					for (let i = 0; i &lt; this.items[page][bank].length; ++i) {
						let item = this.items[page][bank][i]

						if (item.instance == id) {
							this.debug('Deleting item ' + i + ' from button ' + page + '.' + bank)
							this.deleteItem(page, bank.i)
							checkQueue[page + '_' + bank] = true
							i--
						}
					}
				}
			}
		}

		this.save()

		return checkQueue
	}

	/**
	 * Delete an item
	 * @param {number} page - the item's page
	 * @param {number} bank - the item's bank
	 * @param {number} index - the item's index
	 * @access public
	 */
	deleteItem(page, bank, index) {
		if (
			this.items[page] !== undefined &amp;&amp;
			this.items[page][bank] !== undefined &amp;&amp;
			this.items[page][bank][index] !== undefined
		) {
			this.unsubscribeItem(this.items[page][bank][index])
			this.items[page][bank].splice(index, 1)
		}
	}

	/**
	 * Delete an item from a bank via a client socket
	 * @param {number} page - the item's page
	 * @param {number} bank - the item's bank
	 * @param {string} index - the item's id (`item.id`)
	 * @param {function} answer - UI callback
	 * @access public
	 */
	deleteItemByClient(page, bank, id, answer) {
		let ba = this.items[page][bank]

		for (let n in ba) {
			if (ba[n].id == id) {
				this.deleteItem(page, bank, index)
				break
			}
		}

		this.save()
		answer(page, bank, this.items[page][bank])
		this.bank.checkBankStatus(page, bank)
	}

	/**
	 * Get the entire items array
	 * @param {boolean} [clone = false] - &lt;code>true&lt;/code> if a clone is needed instead of a link
	 * @returns {Object} the array in the form `[page][bank][item]`
	 * @access public
	 */
	getAll(clone = false) {
		let out

		if (this.items !== undefined) {
			if (clone === true) {
				out = cloneDeep(this.items)

				// cleanup old keys
				for (let p in out) {
					for (let b in out[p]) {
						for (let i in out[p][b]) {
							if (out[p][b][i].action !== undefined &amp;&amp; out[p][b][i].type !== undefined) {
								delete out[p][b][i].action
							}

							if (out[p][b][i].instance_id !== undefined &amp;&amp; out[p][b][i].instance !== undefined) {
								delete out[p][b][i].instance_id
							}
						}
					}
				}
			} else {
				out = this.items
			}
		}

		return out
	}

	/**
	 * Get the items in a bank
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @param {boolean} [clone = false] - &lt;code>true&lt;/code> if a clone is needed instead of a link
	 * @returns {BankItem[]} the items array
	 * @access public
	 */
	getBank(page, bank, clone = false) {
		this.checkBankExists(page, bank)
		let out

		if (clone === true) {
			out = cloneDeep(this.items[page][bank])

			// cleanup old keys
			for (let i in out) {
				if (out[i].action !== undefined &amp;&amp; out[i].type !== undefined) {
					delete out[i].action
				}

				if (out[i].instance_id !== undefined &amp;&amp; out[i].instance !== undefined) {
					delete out[i].instance_id
				}
			}
		} else {
			out = this.items[page][bank]
		}

		return out
	}

	/**
	 * Get the items in a bank via a client socket
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @param {function} answer - UI callback
	 * @access public
	 */
	getBankByClient(page, bank, answer) {
		answer(page, bank, this.getBank(page, bank))
	}

	/**
	 * Get all the items for a specific instance
	 * @param {string} id - the instance id
	 * @param {boolean} [clone = false] - &lt;code>true&lt;/code> if a clone is needed instead of a link
	 * @returns {BankItem[]} the items array
	 * @access public
	 */
	getInstanceItems(id, clone = false) {
		let out = []

		for (let page in this.items) {
			for (let bank in this.items[page]) {
				for (let i in this.items[page][bank]) {
					let item = this.items[page][bank][i]
					if (item.instance == id) {
						out.push(item)
					}
				}
			}
		}

		if (clone === true) {
			out = cloneDeep(out)
		}

		return out
	}

	/**
	 * Get the items on a page
	 * @param {number} page - the page number
	 * @param {boolean} [clone = false] - &lt;code>true&lt;/code> if a clone is needed instead of a link
	 * @returns {Array.&lt;number,Array.&lt;BankItem>>} the array in the form `[bank][item]`
	 * @access public
	 */
	getPage(page, clone = false) {
		let out

		if (this.items[page] !== undefined) {
			if (clone === true) {
				out = cloneDeep(this.items[page])

				// cleanup old keys
				for (let b in out) {
					for (let i in out[b]) {
						if (out[b][i].action !== undefined &amp;&amp; out[b][i].type !== undefined) {
							delete out[b][i].action
						}

						if (out[b][i].instance_id !== undefined &amp;&amp; out[b][i].instance !== undefined) {
							delete out[b][i].instance_id
						}
					}
				}
			} else {
				out = this.items[page]
			}
		}

		return out
	}

	/**
	 * Import and subscribe items to a bank
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @param {BankItem[]} items - the items to import
	 * @access public
	 */
	importBank(page, bank, items) {
		if (items !== undefined) {
			if (this.items[page] === undefined) {
				this.items[page] = {}
			}

			if (this.items[page][bank] === undefined) {
				this.items[page][bank] = []
			}

			for (let i = 0; i &lt; items.length; ++i) {
				let obj = items[i]
				obj.id = shortid.generate()
				this.items[page][bank].push(obj)
			}

			this.subscribeBank(page, bank)
		}
	}

	/**
	 * Unsubscribe, clear a bank, and save
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @access public
	 */
	resetBank(page, bank) {
		this.unsubscribeBank(page, bank)

		if (this.items[page] === undefined) {
			this.items[page] = {}
		}
		this.items[page][bank] = []

		this.save()
	}

	/**
	 * Flag the database to save
	 * @access public
	 */
	save() {
		//this.db.setKey(this.dbKey, this.items);
		this.db.setDirty()
		this.debug('saving')
	}

	/**
	 * Set a new definitions array
	 * @param {BankItemDefinition[]} definitions - the new definitions
	 * @access public
	 */
	setDefinitions(definitions) {
		this.definitions = definitions
	}

	/**
	 * Find a subscribe function for an item and execute it
	 * @param {BankItem} item - the item object
	 * @access protected
	 */
	subscribe(item) {
		if (item.type !== undefined &amp;&amp; item.instance !== undefined) {
			if (this.definitions[item.instance] !== undefined &amp;&amp; this.definitions[item.instance][item.type] !== undefined) {
				let definition = this.definitions[item.instance][item.type]
				// Run the subscribe function if needed
				if (definition.subscribe !== undefined &amp;&amp; typeof definition.subscribe == 'function') {
					definition.subscribe(item)
				}
			}
		}
	}

	/**
	 * Execute subscribes for all the items in a bank
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @access public
	 */
	subscribeBank(page, bank) {
		if (this.items[page] !== undefined &amp;&amp; this.items[page][bank] !== undefined) {
			// find all instance-ids in items for bank
			for (let i in this.items[page][bank]) {
				this.subscribe(this.items[page][bank][i])
			}
		}
	}

	/**
	 * Find an unsubscribe function for an item and execute it
	 * @param {BankItem} item - the item object
	 * @access protected
	 */
	unsubscribe(item) {
		if (item.type !== undefined &amp;&amp; item.instance !== undefined) {
			if (this.definitions[item.instance] !== undefined &amp;&amp; this.definitions[item.instance][item.type] !== undefined) {
				let definition = this.definitions[item.instance][item.type]
				// Run the subscribe function if needed
				if (definition.unsubscribe !== undefined &amp;&amp; typeof definition.unsubscribe == 'function') {
					definition.unsubscribe(item)
				}
			}
		}
	}

	/**
	 * Execute unsubscribes for all the items in a bank
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @access public
	 */
	unsubscribeBank(page, bank) {
		if (this.items[page] !== undefined &amp;&amp; this.items[page][bank] !== undefined) {
			// find all instance-ids in items for bank
			for (let i in this.items[page][bank]) {
				this.unsubscribe(this.items[page][bank][i])
			}
		}
	}

	/**
	 * Update an option for an item, subscribe, and save
	 * @param {number} page - the item's page
	 * @param {number} bank - the item's bank
	 * @param {string} item - the item's id (`item.id`)
	 * @param {string} option - the option id/key
	 * @param {(string|string[]|number|boolean)} value - the new value
	 * @access public
	 */
	updateItemOption(page, bank, item, option, value) {
		this.debug('bank_update_item_option', page, bank, item, option, value)
		let bp = this.getBank(page, bank)

		if (bp !== undefined) {
			for (let n in bp) {
				let obj = bp[n]
				if (obj !== undefined &amp;&amp; obj.id === item) {
					this.unsubscribeItem(obj)
					if (obj.options === undefined) {
						obj.options = {}
					}
					obj.options[option] = value
					this.subscribeItem(obj)
					this.save()
				}
			}
		}
	}

	/**
	 * Update a bank item order by swapping two keys
	 * @param {number} page - the bank's page
	 * @param {number} bank - the bank number
	 * @param {number} oldIndex - the moving item's index
	 * @param {number} newIndex - the other index to swap with
	 * @access public
	 */
	updateItemOrder(page, bank, oldIndex, newIndex) {
		let bp = this.getBank(page, bank)

		if (bp !== undefined) {
			bp.splice(newIndex, 0, bp.splice(oldIndex, 1)[0])
			this.save()
		}
	}
}

exports = module.exports = BankItemsBase
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://bitfocus.io/images/topbar-logowhite.png" style="width: 147px; height: 24px">
    <div class="footer-text"> </div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
